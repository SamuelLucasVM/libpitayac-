image: Visual Studio 2022

clone_folder: '%USERPROFILE%\go\src\github.com\topfreegames\libpitaya'

environment:
  nodejs_version: "Current"

build:
  verbosity: detailed

configuration: Release

platform: x64

artifacts:
  - path: '_builds\windows\Release\*.dll'
    name: Dlls

  - path: '_builds\windows\Release\*.lib'
    name: Libs

install:
  - call "C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvars64.bat"

before_build:
  - cd %USERPROFILE%\go\src\github.com\topfreegames\libpitaya

build_script:
  - make build-windows

after_build:
  - dir _builds\windows\Release

deploy:
  description: 'Release'
  provider: GitHub
  draft: true
  auth_token:
    secure: "zZylescCEij0QU44MySw8xIQgBjmRJfD/p/42ddQQoxLoFzC4TP+kkZm3ywsrKo6"
  artifact: /.*\.dll|.*\.lib/
  on:
    appveyor_repo_tag: true

